ğŸ¨ Texture Conversion Pipeline
Rice (Glide) âœ o2r (NextGen) Format for Ship of Harkinian
ğŸ“˜ Project Description

This pipeline automates conversion of Ocarina of Time community texture packs from the legacy Rice/Glide system to the modern o2r format used by Ship of Harkinian (SoH). It uses perceptual hashing to match textures by content, allowing accurate conversion even when filenames differ or metadata is missing.

ğŸ¯ Key Features

âš¡ Efficient 3-stage pipeline: hash once, match many times

ğŸ” Duplicate-aware: handles textures reused across multiple game assets

ğŸšï¸ Configurable Hamming distance thresholds for match quality

ğŸ”’ Safe: original texture files are never modified

ğŸ“ Detailed reporting with CSV and JSON outputs

ğŸš€ Fast rematching: cached hashes make experimentation instant

ğŸ“ Texture Formats
1. ğŸ§© Rice / Glide Format (Legacy)

Used by emulators like Mupen64Plus and Project64 (GlideN64 plugin)

Filenames use hash-based identifiers, e.g.
THE_LEGEND_OF_ZELDA#92C1F51C#4#1_rgb.png

Lookup is done via N64 RAM hashing

Flat directory structure, no hierarchy

2. ğŸ—‚ï¸ o2r Format (Modern)

Used by Ship of Harkinian

Human-readable, structured names, e.g.
objects/gameplay_keep/gEffBombExplosion1Tex.png

Loaded by direct filepath

Organized directory structure representing game assets

ğŸš€ Pipeline Overview
Step 1: hash.py
Calculate perceptual hashes (one-time)
python hash.py


Generates perceptual hashes for all textures

Saves hash results into JSON files

Slow step, but only runs once per input directory

Supports multiple formats and color modes automatically

Step 2: map.py
Create cross-format texture mappings (repeatable)
python map.py


Loads previously generated hashes

Matches Glide textures to o2r textures

Fully configurable Hamming threshold (0â€“10)

Produces a CSV containing all matching paths (duplicate aware)

Extremely fast when re-running with new thresholds

Step 3: convert.py
Convert texture packs into o2r format (repeatable)
python convert.py


Uses the mapping file to copy textures to all matching o2r destinations

Never alters original files

Produces detailed reports and logs

Supports multiple conversion runs with different maps

ğŸ› ï¸ Installation
pip install imagehash Pillow tqdm

ğŸ“‚ Directory Layout
project/
â”œâ”€â”€ hash.py                     # Step 1: Hash calculator
â”œâ”€â”€ map.py                      # Step 2: Mapping generator
â”œâ”€â”€ convert.py                  # Step 3: Texture converter
â”œâ”€â”€ glide_hashes_*.json         # Generated by hash.py (Glide format)
â”œâ”€â”€ soh_hashes_*.json           # Generated by hash.py (o2r format)
â”œâ”€â”€ texture_map_*.csv           # Generated by map.py
â”œâ”€â”€ converted_*/                # Generated by convert.py
â””â”€â”€ README.md

ğŸ“Š Understanding Hamming Distance

Perceptual hashing generates 64-bit fingerprints of images.
Hamming distance measures how many bits differ.

0 â†’ Perfect match (identical)

1â€“2 â†’ Very similar (recommended default)

3â€“4 â†’ Some risk of mismatches

5+ â†’ Low confidence, high false-positive risk

Recommendation: Start at 2 or lower and raise only if coverage is too low.

ğŸ® Why This Pipeline Is Needed

Community texture packs exist almost entirely in Rice format.
To make them usable in SoH, we need to:

Match Rice community textures to Rice reference textures (filename hash)

Match those Rice textures to o2r equivalents (content match via hashing)

Convert and place community textures into the correct o2r folder structure

This system automates the entire process.

ğŸ”„ Duplicate Texture Handling

Many game textures are reused across multiple assets.
This pipeline:

Detects duplicates during mapping

Records all matching o2r paths

Copies converted textures to every required location

Reports duplicate patterns and counts

Without this, textures would appear only in one location, causing obvious missing-texture bugs.

ğŸ“ˆ Performance Metrics

Total processing after hashing: ~30 seconds for 45k+ textures

Match rates: 40â€“60 percent depending on pack

Average duplicates: 2â€“3 o2r entries per Glide texture

Accuracy: 99 percent at Hamming â‰¤ 2

ğŸ“ Usage Examples
Basic workflow
# Step 1: Hash directories (run once per directory)
python hash.py      # Run for Glide directory
python hash.py      # Run for o2r directory

# Step 2: Create mappings with safe threshold
python map.py       # Choose Hamming <= 2

# Step 3: Convert texture packs
python convert.py

Advanced: experimenting with thresholds
python map.py   # Create map_hamming2.csv     (conservative)
python map.py   # Create map_hamming3.csv     (moderate)
python map.py   # Create map_hamming4.csv     (aggressive)

python convert.py   # Use map_hamming2.csv
python convert.py   # Use map_hamming3.csv

ğŸ“Š Output Files
hash.py

glide_hashes_YYYYMMDD_HHMMSS.json

soh_hashes_YYYYMMDD_HHMMSS.json

Statistics reports

map.py

texture_map_YYYYMMDD_HHMMSS.csv

JSON statistics file

Duplicate and Hamming distance analysis

convert.py

converted_YYYYMMDD_HHMMSS/ output directory

conversion_report_*.csv detailed logs

JSON debug and statistics file

âš ï¸ Limitations and Considerations

Not all community textures have a matching o2r equivalent

False positives possible at Hamming > 3

Manual review recommended for aggressive thresholds

Updating texture packs requires re-hashing

ğŸ¤ Collaboration Notes

This project helps the Ocarina of Time modding community:

Preserve legacy texture work

Standardize on modern formats

Reduce thousands of hours of manual labor

Improve accessibility across emulator and port ecosystems

ğŸ† Credits

Ryan Giovanazzi

Ian Skelsky

Ocarina Reloaded Team

Ship of Harkinian Team

GlideN64 Developers

Community Texture Artists

ğŸ”— Links

Ship of Harkinian: https://github.com/HarbourMasters/

Ocarina of Time HD Texture Project: https://github.com/GhostlyDark/

GlideN64: https://github.com/gonetz/

Ian Skelsky: https://github.com/IanSkelskey

This pipeline serves as a bridge between emulator generations, ensuring community texture packs remain usable as the ecosystem evolves.
